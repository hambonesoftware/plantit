#app{
  min-height:100vh;
  margin:0 auto;
  max-width:1440px;
  padding:calc(var(--gap)*2);
  display:flex;
  flex-direction:column;
  gap:var(--gap);
}

.app-shell{
  background:var(--panel);
  border-radius:var(--radius-2xl);
  box-shadow:var(--shadow-md);
  padding:calc(var(--gap)*0.75) var(--gap);
  display:flex;
  align-items:center;
  gap:var(--gap);
}

.app-shell .logo{
  display:flex;
  align-items:center;
  gap:calc(var(--gap)/2);
  font-weight:700;
  font-size:1.1rem;
  text-decoration:none;
  color:inherit;
}

.app-shell .logo .leaf{
  width:32px;
  height:32px;
  border-radius:var(--radius-xl);
  background:var(--accent-weak);
  display:inline-flex;
  align-items:center;
  justify-content:center;
  font-size:1.1rem;
}

.app-shell .spacer{flex:1}

.app-shell .search{
  display:flex;
  align-items:center;
  width:420px;
  max-width:100%;
}

.app-shell .search input[type=search]{
  width:100%;
  border-radius:var(--radius-xl);
  border:1px solid color-mix(in srgb, var(--muted) 20%, var(--panel));
  background:color-mix(in srgb, var(--bg) 70%, var(--panel));
  padding:0.65rem 0.9rem;
}

.app-shell .search input[type=search]::placeholder{color:color-mix(in srgb, var(--muted) 60%, var(--panel))}

.app-shell .icons{
  display:flex;
  gap:calc(var(--gap)/1.5);
  align-items:center;
  color:var(--muted);
}

.app-shell .icon-btn{
  border:none;
  background:transparent;
  color:inherit;
  font-size:1.1rem;
  padding:0.35rem;
  border-radius:var(--radius-xl);
  cursor:pointer;
}

.app-shell .icon-btn:hover{color:var(--text);}

.app-shell .avatar{
  width:36px;
  height:36px;
  border-radius:50%;
  background:color-mix(in srgb, var(--accent-weak) 60%, var(--panel));
  display:inline-block;
}

.layout{
  display:grid;
  grid-template-columns:minmax(0,1fr) 360px;
  gap:calc(var(--gap)*1.5);
}

.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit, minmax(var(--card-w), 1fr));
  gap:calc(var(--gap)*1.25);
}

.view-stack{display:flex;flex-direction:column;gap:var(--gap)}

.village-view{
  display:flex;
  flex-direction:column;
  gap:calc(var(--gap)*1.25);
}

.village-header{
  background:var(--panel);
  border-radius:var(--radius-2xl);
  box-shadow:var(--shadow-md);
  padding:var(--gap);
  display:flex;
  align-items:center;
  gap:var(--gap);
  justify-content:space-between;
}

.village-header .back{color:var(--accent);}

.quick-form{
  display:none;
  margin-top:calc(var(--gap)/1.5);
  background:color-mix(in srgb, var(--bg) 85%, var(--panel));
  padding:calc(var(--gap)/1.25);
  border-radius:var(--radius-xl);
  flex-direction:column;
  gap:calc(var(--gap)/1.5);
}

.quick-form.open{display:flex}

.quick-form .quick-fields{display:flex;flex-wrap:wrap;gap:calc(var(--gap)/1.5);align-items:flex-end}
.quick-form input{padding:0.45rem 0.65rem;border-radius:var(--radius-xl);border:1px solid color-mix(in srgb, var(--muted) 25%, var(--panel));}
.quick-form .btn{padding:0.45rem 0.9rem}
.quick-form .form-message{font-size:0.8rem;color:var(--muted)}

.quick-add-panel{
  background:var(--panel);
  border-radius:var(--radius-2xl);
  box-shadow:var(--shadow-md);
  padding:var(--gap);
  display:flex;
  flex-direction:column;
  gap:calc(var(--gap)/1.5);
}

.quick-add-form{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:calc(var(--gap)/1.25);align-items:flex-end}
.quick-add-form label{display:flex;flex-direction:column;gap:0.35rem;font-size:0.85rem;color:var(--muted)}
.quick-add-form input,.quick-add-form textarea{padding:0.55rem 0.7rem;border-radius:var(--radius-xl);border:1px solid color-mix(in srgb, var(--muted) 25%, var(--panel));}
.quick-add-form .form-message{grid-column:1/-1;font-size:0.8rem;color:var(--muted)}
.quick-add-form.busy{opacity:0.6;pointer-events:none}

.plant-list{display:flex;flex-direction:column;gap:var(--gap)}
.plant-row{display:flex;justify-content:space-between;align-items:center;background:var(--panel);border-radius:var(--radius-2xl);box-shadow:var(--shadow-md);padding:var(--gap);gap:var(--gap)}
.plant-row .plant-meta h4{margin:0;font-size:1.1rem}
.plant-row .plant-actions{display:flex;gap:calc(var(--gap)/1.5);align-items:center}

.loading-state,.empty-state{background:color-mix(in srgb, var(--bg) 90%, var(--panel));border-radius:var(--radius-xl);padding:calc(var(--gap));text-align:center;color:var(--muted);font-size:0.9rem}

.plant-modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:20}
.plant-modal.hidden{display:none}
.modal-backdrop{position:absolute;inset:0;background:rgba(15,23,42,0.35)}
.modal-panel{position:relative;background:var(--panel);border-radius:var(--radius-2xl);box-shadow:var(--shadow-md);max-width:520px;width:min(520px,calc(100vw - 48px));max-height:90vh;overflow:auto;padding:calc(var(--gap)*1.25);display:flex;flex-direction:column;gap:var(--gap)}
.modal-panel .close{align-self:flex-end;font-size:1.4rem;color:var(--muted)}
.plant-modal-body{display:flex;flex-direction:column;gap:calc(var(--gap)*1.25)}
.plant-modal-header h2{margin:0}

.schedule-form,.water-form{display:flex;flex-direction:column;gap:calc(var(--gap)/1.25)}
.schedule-form label,.water-form label{display:flex;flex-direction:column;gap:0.35rem;font-size:0.85rem;color:var(--muted)}
.schedule-form input,.water-form textarea{padding:0.55rem 0.75rem;border-radius:var(--radius-xl);border:1px solid color-mix(in srgb, var(--muted) 25%, var(--panel));font:inherit}
.water-form textarea{min-height:80px;resize:vertical}
.form-row{display:flex;align-items:center;gap:calc(var(--gap)/1.5)}
.form-message{font-size:0.8rem;color:var(--muted)}
.schedule-form.busy,.water-form.busy,.quick-form.busy{opacity:0.6;pointer-events:none}

.plant-logs{display:flex;flex-direction:column;gap:calc(var(--gap)/1.5)}
.log-list{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:calc(var(--gap)/2)}
.log-list li{display:flex;flex-direction:column;gap:0.25rem;background:color-mix(in srgb, var(--bg) 88%, var(--panel));border-radius:var(--radius-xl);padding:calc(var(--gap)/1.5)}
.log-kind{font-weight:600;text-transform:capitalize}
.log-date{font-size:0.8rem;color:var(--muted)}
.log-note{font-size:0.9rem}

.today-header{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid color-mix(in srgb, var(--muted) 12%, var(--panel));padding-bottom:calc(var(--gap)/2)}
.today-list{display:flex;flex-direction:column;gap:calc(var(--gap)/1.5)}
.today-calendar{margin-top:calc(var(--gap)/1.5)}

.card{
  background:var(--panel);
  border-radius:var(--radius-2xl);
  box-shadow:var(--shadow-md);
  overflow:hidden;
  display:flex;
  flex-direction:column;
}

.card .img{
  height:180px;
  background:color-mix(in srgb, var(--accent-weak) 55%, var(--bg));
}

.card .body{padding:var(--gap)}

.row{
  display:flex;
  align-items:center;
  gap:calc(var(--gap)/2);
  flex-wrap:wrap;
}

.title{
  font-weight:700;
  font-size:1.35rem;
  margin:0 0 calc(var(--gap)/2);
}

.meta{color:var(--muted);font-size:0.9rem;margin-top:calc(var(--gap)/2)}

.actions{
  display:flex;
  gap:calc(var(--gap)/1.25);
  margin-top:calc(var(--gap)*0.75);
}

.btn{
  border:none;
  background:color-mix(in srgb, var(--accent-weak) 35%, var(--panel));
  color:var(--accent);
  padding:0.55rem 0.9rem;
  border-radius:var(--radius-xl);
  box-shadow:var(--shadow-sm);
  cursor:pointer;
  transition:transform 120ms ease;
}

.btn:hover{transform:translateY(-1px)}

.badge{
  display:inline-flex;
  align-items:center;
  gap:0.3rem;
  border-radius:999px;
  padding:0.35rem 0.7rem;
  font-size:0.75rem;
  font-weight:600;
}

.badge.green{
  background:var(--accent-weak);
  color:var(--accent);
}

.badge.gray{
  background:color-mix(in srgb, var(--muted) 12%, var(--panel));
  color:var(--muted);
}

.badge.red{
  background:color-mix(in srgb, var(--warn) 18%, var(--panel));
  color:var(--warn);
}

.panel{
  background:var(--panel);
  border-radius:var(--radius-2xl);
  box-shadow:var(--shadow-md);
  padding:var(--gap);
  display:flex;
  flex-direction:column;
  gap:calc(var(--gap)/1.5);
  height:max-content;
}

.panel h3{margin:0;font-size:1.1rem}

.todo{
  display:flex;
  align-items:flex-start;
  gap:calc(var(--gap)/2);
}

.todo input[type=checkbox]{
  margin-top:0.3rem;
  width:1.1rem;
  height:1.1rem;
}

.todo .overdue{color:var(--warn);font-size:0.8rem;margin-left:0.3rem}

.calendar{
  border-top:1px solid color-mix(in srgb, var(--muted) 12%, var(--panel));
  padding-top:calc(var(--gap)/1.25);
}

.calendar header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:calc(var(--gap)/1.5);
  color:var(--muted);
  font-size:0.85rem;
}

.calendar .grid{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:calc(var(--gap)/3);
}

.calendar .day{
  height:32px;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:var(--radius-xl);
  background:color-mix(in srgb, var(--bg) 80%, var(--panel));
  position:relative;
}

.calendar .dot{
  position:absolute;
  bottom:6px;
  width:6px;
  height:6px;
  border-radius:50%;
  background:var(--accent);
}

.footer{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:calc(var(--gap));
  margin-top:var(--gap);
  flex-wrap:wrap;
}

.footer-buttons{
  display:flex;
  gap:calc(var(--gap)/1.5);
  align-items:center;
}

.status-text{
  margin:0;
  font-size:0.85rem;
  color:var(--muted);
  min-height:1.2em;
}

.status-text[data-variant="error"]{color:var(--warn);}
.status-text[data-variant="success"]{color:var(--accent);}

.link-btn{
  border:none;
  background:transparent;
  color:var(--muted);
  cursor:pointer;
  font-weight:600;
  text-decoration:underline;
}

@media (max-width:1200px){
  .layout{grid-template-columns:1fr}
}
